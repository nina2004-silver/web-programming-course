<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LR5: React –ü–∞—Ç—Ç–µ—Ä–Ω—ã, –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ API - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –ü—Ä–∏–º–µ—Ä—ã</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 40px 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    h1 {
      color: white;
      text-align: center;
      margin-bottom: 40px;
      font-size: 2.5rem;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }
    
    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    .tab {
      padding: 12px 24px;
      background: rgba(255,255,255,0.2);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s;
      backdrop-filter: blur(10px);
    }
    
    .tab:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-2px);
    }
    
    .tab.active {
      background: white;
      color: #667eea;
      font-weight: 600;
    }
    
    .content {
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .demo {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      border: 2px solid #e9ecef;
    }
    
    .demo h3 {
      color: #667eea;
      margin-bottom: 15px;
    }
    
    button {
      padding: 10px 20px;
      margin: 5px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }
    
    button:hover {
      background: #764ba2;
      transform: translateY(-2px);
    }
    
    button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }
    
    input {
      padding: 10px;
      border: 2px solid #e9ecef;
      border-radius: 6px;
      font-size: 14px;
      margin: 5px;
    }
    
    .card {
      background: white;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      padding: 15px;
      margin: 10px 0;
    }
    
    .error {
      background: #fee;
      border-left: 4px solid #f44;
      padding: 15px;
      margin: 10px 0;
      border-radius: 4px;
    }
    
    .success {
      background: #efe;
      border-left: 4px solid #4f4;
      padding: 15px;
      margin: 10px 0;
      border-radius: 4px;
    }
    
    .code {
      background: #282c34;
      color: #abb2bf;
      padding: 15px;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      overflow-x: auto;
      margin: 15px 0;
    }
    
    .render-count {
      display: inline-block;
      padding: 5px 10px;
      background: #ff6b6b;
      color: white;
      border-radius: 4px;
      font-weight: bold;
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üöÄ LR5: React –ü–∞—Ç—Ç–µ—Ä–Ω—ã, –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ API</h1>
    
    <div class="tabs">
      <button class="tab active" onclick="showTab('patterns')">–ü–∞—Ç—Ç–µ—Ä–Ω—ã</button>
      <button class="tab" onclick="showTab('errorBoundary')">Error Boundaries</button>
      <button class="tab" onclick="showTab('optimization')">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</button>
      <button class="tab" onclick="showTab('reactQuery')">React Query</button>
    </div>
    
    <div class="content">
      <!-- Tab 1: –ü–∞—Ç—Ç–µ—Ä–Ω—ã -->
      <div id="patterns" class="tab-content active">
        <h2>React –ü–∞—Ç—Ç–µ—Ä–Ω—ã (–ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –∏–∑ LR2)</h2>
        
        <div class="demo">
          <h3>1. Custom Hook: useToggle</h3>
          <div id="toggleDemo"></div>
          <button onclick="demoToggle()">Toggle</button>
          
          <div class="code">
function useToggle(initial = false) {
  const [value, setValue] = useState(initial);
  const toggle = () => setValue(v => !v);
  return { value, toggle };
}</div>
        </div>
        
        <div class="demo">
          <h3>2. Compound Components: Card</h3>
          <div class="card">
            <div style="font-weight: bold; margin-bottom: 10px;">Card Header</div>
            <div style="margin-bottom: 10px;">Card Body Content</div>
            <div style="border-top: 1px solid #ddd; padding-top: 10px;">
              <button>Card Footer Action</button>
            </div>
          </div>
          
          <div class="code">
&lt;Card&gt;
  &lt;Card.Header&gt;Title&lt;/Card.Header&gt;
  &lt;Card.Body&gt;Content&lt;/Card.Body&gt;
  &lt;Card.Footer&gt;Action&lt;/Card.Footer&gt;
&lt;/Card&gt;</div>
        </div>
        
        <div class="demo">
          <h3>3. Context API: Theme</h3>
          <div id="themeDemo">Current theme: <span id="currentTheme">light</span></div>
          <button onclick="toggleTheme()">Toggle Theme</button>
          
          <div class="code">
const ThemeContext = createContext();

function ThemeProvider({ children }) {
  const [theme, setTheme] = useState('light');
  return (
    &lt;ThemeContext.Provider value={{ theme, setTheme }}&gt;
      {children}
    &lt;/ThemeContext.Provider&gt;
  );
}</div>
        </div>
      </div>
      
      <!-- Tab 2: Error Boundaries -->
      <div id="errorBoundary" class="tab-content">
        <h2>Error Boundaries</h2>
        
        <div class="demo">
          <h3>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –æ—à–∏–±–∫–∏</h3>
          <p>Error Boundary –ª–æ–≤–∏—Ç –æ—à–∏–±–∫–∏ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ:</p>
          
          <div id="errorBoundaryDemo">
            <button onclick="throwError()">–í—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫—É (—Å–∏–º—É–ª—è—Ü–∏—è)</button>
          </div>
          
          <div class="code">
class ErrorBoundary extends Component {
  state = { hasError: false, error: null };
  
  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }
  
  componentDidCatch(error, errorInfo) {
    console.error('Error:', error, errorInfo);
  }
  
  render() {
    if (this.state.hasError) {
      return &lt;div&gt;Something went wrong&lt;/div&gt;;
    }
    return this.props.children;
  }
}</div>
          
          <div style="margin-top: 20px;">
            <strong>–ß—Ç–æ –ù–ï –ª–æ–≤–∏—Ç Error Boundary:</strong>
            <ul style="margin-left: 20px; margin-top: 10px;">
              <li>‚ùå –û—à–∏–±–∫–∏ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö —Å–æ–±—ã—Ç–∏–π (onClick)</li>
              <li>‚ùå –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ (setTimeout, fetch)</li>
              <li>‚úÖ –û—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</li>
            </ul>
          </div>
        </div>
      </div>
      
      <!-- Tab 3: Optimization -->
      <div id="optimization" class="tab-content">
        <h2>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>
        
        <div class="demo">
          <h3>1. React.memo - –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞</h3>
          <p>–ë–µ–∑ memo: <span class="render-count" id="withoutMemo">0</span> —Ä–µ–Ω–¥–µ—Ä–æ–≤</p>
          <p>–° memo: <span class="render-count" id="withMemo">0</span> —Ä–µ–Ω–¥–µ—Ä–æ–≤</p>
          <button onclick="triggerRerender()">–í—ã–∑–≤–∞—Ç—å —Ä–µ-—Ä–µ–Ω–¥–µ—Ä</button>
          
          <div class="code">
const ExpensiveComponent = memo(({ data }) => {
  console.log('Render');
  return &lt;div&gt;{data.name}&lt;/div&gt;;
});
// –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ä–µ-—Ä–µ–Ω–¥–µ—Ä –µ—Å–ª–∏ props –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å</div>
        </div>
        
        <div class="demo">
          <h3>2. useMemo - –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π</h3>
          <input id="filterInput" placeholder="–§–∏–ª—å—Ç—Ä..." oninput="demoFilter()">
          <div id="filterResult"></div>
          <p style="margin-top: 10px;">–í—ã—á–∏—Å–ª–µ–Ω–∏–π: <span class="render-count" id="filterCount">0</span></p>
          
          <div class="code">
const filtered = useMemo(() => {
  console.log('Filtering...');
  return products.filter(p => p.name.includes(filter));
}, [products, filter]);
// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ products –∏–ª–∏ filter</div>
        </div>
        
        <div class="demo">
          <h3>3. useCallback - –ú–µ–º–æ–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π</h3>
          <p>useCallback –Ω—É–∂–µ–Ω –∫–æ–≥–¥–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å React.memo</p>
          
          <div class="code">
// ‚ùå –ë–µ–∑ useCallback
const handleClick = () => doSomething();
// –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫–∞–∂–¥—ã–π —Ä–µ–Ω–¥–µ—Ä

// ‚úÖ –° useCallback
const handleClick = useCallback(() => {
  doSomething();
}, []); // –¢–∞ –∂–µ —Ñ—É–Ω–∫—Ü–∏—è</div>
        </div>
        
        <div class="demo">
          <h3>–ü—Ä–∞–≤–∏–ª–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</h3>
          <div style="background: #fff3cd; padding: 15px; border-radius: 6px; border-left: 4px solid #ffc107;">
            <strong>‚ö†Ô∏è –ù–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ!</strong>
            <ol style="margin-left: 20px; margin-top: 10px;">
              <li>–ò–∑–º–µ—Ä–∏—Ç—å (React Profiler)</li>
              <li>–ù–∞–π—Ç–∏ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞</li>
              <li>–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å</li>
              <li>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</li>
            </ol>
          </div>
        </div>
      </div>
      
      <!-- Tab 4: React Query -->
      <div id="reactQuery" class="tab-content">
        <h2>React Query - –†–∞–±–æ—Ç–∞ —Å API</h2>
        
        <div class="demo">
          <h3>useQuery - –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</h3>
          <button onclick="fetchUsers()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
          <div id="usersResult"></div>
          
          <div class="code">
const { data, isLoading, error } = useQuery({
  queryKey: ['users'],
  queryFn: fetchUsers,
});

if (isLoading) return &lt;div&gt;Loading...&lt;/div&gt;;
if (error) return &lt;div&gt;Error: {error.message}&lt;/div&gt;;
return &lt;div&gt;{data.map(...)}&lt;/div&gt;;</div>
        </div>
        
        <div class="demo">
          <h3>useMutation - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</h3>
          <input id="userName" placeholder="–ò–º—è" />
          <button onclick="createUser()">–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
          <div id="mutationResult"></div>
          
          <div class="code">
const mutation = useMutation({
  mutationFn: createUser,
  onSuccess: () => {
    // –û–±–Ω–æ–≤–∏—Ç—å –∫—ç—à
    queryClient.invalidateQueries({ queryKey: ['users'] });
  },
});

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
mutation.mutate({ name: 'John' });</div>
        </div>
        
        <div class="demo">
          <h3>queryKey - –ö–ª—é—á–∏ –∫—ç—à–∞</h3>
          <div class="code">
// –ü—Ä–æ—Å—Ç–æ–π
['users']

// –° –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º
['user', userId]

// –° —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
['users', { role: 'admin', active: true }]

// –ò–µ—Ä–∞—Ä—Ö–∏—è
['users']           // –≤—Å–µ users
['users', 1]        // user —Å id=1
['users', 1, 'posts'] // posts user'–∞ 1</div>
        </div>
        
        <div class="demo">
          <h3>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ React Query</h3>
          <ul style="margin-left: 20px;">
            <li>‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ</li>
            <li>‚úÖ –§–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</li>
            <li>‚úÖ –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤</li>
            <li>‚úÖ Optimistic updates</li>
            <li>‚úÖ DevTools –∏–∑ –∫–æ—Ä–æ–±–∫–∏</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // Tab switching
    function showTab(tabName) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Show selected tab
      document.getElementById(tabName).classList.add('active');
      event.target.classList.add('active');
    }
    
    // Demo: Toggle
    let isToggled = false;
    function demoToggle() {
      isToggled = !isToggled;
      document.getElementById('toggleDemo').innerHTML = 
        `<p style="padding: 10px; background: ${isToggled ? '#d4edda' : '#f8d7da'}; border-radius: 4px;">
          Status: ${isToggled ? 'ON' : 'OFF'}
        </p>`;
    }
    demoToggle();
    
    // Demo: Theme
    let currentTheme = 'light';
    function toggleTheme() {
      currentTheme = currentTheme === 'light' ? 'dark' : 'light';
      document.getElementById('currentTheme').textContent = currentTheme;
      document.getElementById('themeDemo').style.background = 
        currentTheme === 'dark' ? '#333' : '#f8f9fa';
      document.getElementById('themeDemo').style.color = 
        currentTheme === 'dark' ? '#fff' : '#000';
    }
    
    // Demo: Error Boundary
    function throwError() {
      document.getElementById('errorBoundaryDemo').innerHTML = `
        <div class="error">
          <strong>‚ö†Ô∏è Something went wrong</strong>
          <p>This error was caught by ErrorBoundary</p>
          <button onclick="location.reload()">Try again</button>
        </div>
      `;
    }
    
    // Demo: React.memo
    let withoutMemoCount = 0;
    let withMemoCount = 0;
    function triggerRerender() {
      withoutMemoCount++;
      // –° memo - –Ω–µ –≤—Å–µ–≥–¥–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è
      if (Math.random() > 0.5) withMemoCount++;
      
      document.getElementById('withoutMemo').textContent = withoutMemoCount;
      document.getElementById('withMemo').textContent = withMemoCount;
    }
    
    // Demo: useMemo filter
    let filterCount = 0;
    const products = [
      { id: 1, name: 'Laptop' },
      { id: 2, name: 'Phone' },
      { id: 3, name: 'Tablet' },
      { id: 4, name: 'Monitor' },
    ];
    
    function demoFilter() {
      filterCount++;
      const filter = document.getElementById('filterInput').value.toLowerCase();
      const filtered = products.filter(p => p.name.toLowerCase().includes(filter));
      
      document.getElementById('filterResult').innerHTML = 
        filtered.map(p => `<div class="card">${p.name}</div>`).join('');
      document.getElementById('filterCount').textContent = filterCount;
    }
    demoFilter();
    
    // Demo: React Query
    function fetchUsers() {
      const result = document.getElementById('usersResult');
      result.innerHTML = '<p>‚è≥ Loading...</p>';
      
      setTimeout(() => {
        const users = [
          { id: 1, name: 'Alice', email: 'alice@example.com' },
          { id: 2, name: 'Bob', email: 'bob@example.com' },
          { id: 3, name: 'Charlie', email: 'charlie@example.com' },
        ];
        
        result.innerHTML = `
          <div class="success">‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã (–∫—ç—à–∏—Ä–æ–≤–∞–Ω–æ)</div>
          ${users.map(u => `
            <div class="card">
              <strong>${u.name}</strong><br>
              <small>${u.email}</small>
            </div>
          `).join('')}
        `;
      }, 1000);
    }
    
    function createUser() {
      const name = document.getElementById('userName').value;
      const result = document.getElementById('mutationResult');
      
      if (!name) {
        result.innerHTML = '<div class="error">–í–≤–µ–¥–∏—Ç–µ –∏–º—è</div>';
        return;
      }
      
      result.innerHTML = '<p>‚è≥ Creating...</p>';
      
      setTimeout(() => {
        result.innerHTML = `
          <div class="success">
            ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å "${name}" —Å–æ–∑–¥–∞–Ω!<br>
            <small>–ö—ç—à –æ–±–Ω–æ–≤–ª—ë–Ω —á–µ—Ä–µ–∑ invalidateQueries</small>
          </div>
        `;
        document.getElementById('userName').value = '';
      }, 1000);
    }
  </script>
</body>
</html>
